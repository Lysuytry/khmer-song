{"version":3,"sources":["../../../../src/api/admin/album/album.api.js"],"names":["getAlbumList","req","res","limit","offset","status","name","type","query","fliterName","Op","like","fliterType","conditions","rows","count","Album","findAndCountAll","where","success","error","fail","message","createAlbum","body","album","findOrCreate","defaults","getAlbumById","id","params","findOne","updateAlbumById","statusQuery","image","productionId","createdBy","updatedBy","result","Production","attributes","data","update","deletedAlbumById"],"mappings":"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","file":"album.api.js","sourcesContent":["import Album from '../../../models/album';\nimport {Op} from '../../../common/sequelize-connection';\nimport Production from '../../../models/production';\n\nexport const getAlbumList = async (req, res) => {\n  try{\n    const {limit, offset, status, name, type} = req.query;\n    const fliterName = name ? {name: { [Op.like]: `%${name}%` }} : {};\n    const fliterType = type ? {type} : {};\n    const conditions = {...fliterName, status, ...fliterType};\n    const {rows, count} = await Album.findAndCountAll({where: conditions, offset, limit});\n    res.success(rows, {limit, offset, count});\n  } catch(error){\n    res.fail(error.message);\n  }\n};\n\nexport const createAlbum = async (req, res) => {\n  try{\n    const {name} = req.body;\n    const [album] = await Album.findOrCreate({where: {name}, defaults: req.body});\n    res.success(album);\n  } catch(error){\n    res.fail(error.message);\n  }\n};\n\nexport const getAlbumById = async (req, res) => {\n  try{\n    const {id} = req.params;\n    const {status} = req.query;\n    const album = await Album.findOne({where: {id, status} });\n    res.success(album);\n  } catch(error){\n    res.fail(error.message);\n  }\n};\n\nexport const updateAlbumById = async (req, res) => {\n  try{\n    const {id} = req.params;\n    const statusQuery = req.query.status;\n    let {name, image, status, productionId, createdBy, updatedBy, type} = req.body;\n    name = name ? {name} : {};\n    image = image ? {image} : {};\n    status = status ? {status} : {};\n\n    const result = productionId ? await Production.findOne({attributes: ['id'], where: {id: productionId}}) : true;\n    if(!result) return res.fail('Production Id is invalid.');\n\n    productionId = productionId ? {productionId} : {};\n    createdBy = createdBy ? {createdBy} : {};\n    updatedBy = updatedBy ? {updatedBy} : {};\n    type = type ? {type} : {};\n    const data = {...name, ...image, ...status, ...productionId, ...createdBy, ...updatedBy, ...type};\n    await Album.update(data, {where: {id, 'status': statusQuery}});\n    res.success('Successfully updated.');\n  } catch(error){\n    res.fail(error.message);\n  }\n};\n\nexport const deletedAlbumById = async (req, res) => {\n  try{\n    const {id} = req.params;\n    const [result] =  await Album.update({status: 'inactive'}, {where: {id, status: 'active'}});\n    result === 0 ? res.fail('If is not found') : res.success('Successfully deleted.');\n  } catch(error){\n    res.fail(error.message);\n  }\n};\n"]}