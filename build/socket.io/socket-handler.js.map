{"version":3,"sources":["../../src/socket.io/socket-handler.js"],"names":["chatHandler","socket","on","userId","data","from","to","messages","broadcast","emit","users","onlineHandler","filter","item","way","id","push"],"mappings":";;;;;;;AAAA;;AACA;;AAEO,MAAMA,oCAAcC,UAAU;AACnCA,SAAOC,EAAP,CAAU,MAAV,EAAkBC,UAAU;AAC1B,+BAAgBA,MAAhB,EAAwBF,MAAxB;AACA;AACA;AACA;AACD,GALD;;AAOAA,SAAOC,EAAP,CAAU,YAAV,EAAwBE,QAAQ;AAC9B,UAAM,EAAEC,IAAF,EAAQC,EAAR,EAAYC,QAAZ,KAAyBH,IAA/B;AACAH,WAAOO,SAAP,CAAiBF,EAAjB,CAAoBA,EAApB,EAAwBG,IAAxB,CAA6B,YAA7B,EAA2C,EAAEH,EAAF,EAAMD,IAAN,EAAYE,QAAZ,EAA3C;AACD,GAHD;AAID,CAZM;;AAcP,IAAIG,QAAQ,EAAZ;AACO,MAAMC,wCAAgBV,UAAU;AACrCA,SAAOC,EAAP,CAAU,QAAV,EAAoBC,UAAU;AAC5BO,YAAQA,MAAME,MAAN,CAAaC,QAAQA,KAAKC,GAAL,KAAab,OAAOc,EAAzC,CAAR;AACAL,UAAMM,IAAN,CAAW,EAAED,IAAIZ,MAAN,EAAcW,KAAKb,OAAOc,EAA1B,EAAX;AACAd,WAAOQ,IAAP,CAAY,cAAZ,EAA4BC,KAA5B;AACAT,WAAOO,SAAP,CAAiBC,IAAjB,CAAsB,cAAtB,EAAsCC,KAAtC;AACD,GALD;;AAOAT,SAAOC,EAAP,CAAU,YAAV,EAAwB,MAAM;AAC5BQ,YAAQA,MAAME,MAAN,CAAaC,QAAQA,KAAKC,GAAL,KAAab,OAAOc,EAAzC,CAAR;AACAd,WAAOQ,IAAP,CAAY,cAAZ,EAA4BC,KAA5B;AACAT,WAAOO,SAAP,CAAiBC,IAAjB,CAAsB,cAAtB,EAAsCC,KAAtC;AACD,GAJD;AAKD,CAbM","file":"socket-handler.js","sourcesContent":["import { joinAllChatRoom } from '../api/room/room.api';\n//let listChat = {};\n\nexport const chatHandler = socket => {\n  socket.on('join', userId => {\n    joinAllChatRoom(userId, socket);\n    //socket.join(roomId);\n    //joinChatRoomById(roomId, socket);\n    //listChat.push({ room: roomId, socketId: socket.id});\n  });\n\n  socket.on('newMessage', data => {\n    const { from, to, messages } = data;\n    socket.broadcast.to(to).emit('addMessage', { to, from, messages });\n  });\n};\n\nlet users = [];\nexport const onlineHandler = socket => {\n  socket.on('online', userId => {\n    users = users.filter(item => item.way !== socket.id);\n    users.push({ id: userId, way: socket.id });\n    socket.emit('updateOnline', users);\n    socket.broadcast.emit('updateOnline', users);\n  });\n\n  socket.on('disconnect', () => {\n    users = users.filter(item => item.way !== socket.id);\n    socket.emit('updateOnline', users);\n    socket.broadcast.emit('updateOnline', users);\n  });\n};\n"]}