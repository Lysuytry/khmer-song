{"version":3,"sources":["../../src/socket.io/socket-handler.js"],"names":["chatHandler","socket","on","userId","data","from","to","messages","id","broadcast","emit","users","onlineHandler","filter","item","way","push"],"mappings":";;;;;;;AAAA;;AACA;;AAEO,MAAMA,oCAAcC,UAAU;AACnCA,SAAOC,EAAP,CAAU,MAAV,EAAkBC,UAAU;AAC1B,+BAAgBA,MAAhB,EAAwBF,MAAxB;AACD,GAFD;;AAIAA,SAAOC,EAAP,CAAU,YAAV,EAAwBE,QAAQ;AAC9B,UAAM,EAAEC,IAAF,EAAQC,EAAR,EAAYC,QAAZ,KAAyBH,IAA/B;AACA,kCAAY,EAAEI,IAAI,EAAN,EAAUH,IAAV,EAAgBC,EAAhB,EAAoBC,QAApB,EAAZ;AACAN,WAAOQ,SAAP,CAAiBH,EAAjB,CAAoBA,EAApB,EAAwBI,IAAxB,CAA6B,YAA7B,EAA2C,EAAEJ,EAAF,EAAMD,IAAN,EAAYE,QAAZ,EAA3C;AACD,GAJD;AAKD,CAVM;;AAYP,IAAII,QAAQ,EAAZ;AACO,MAAMC,wCAAgBX,UAAU;AACrCA,SAAOC,EAAP,CAAU,QAAV,EAAoBC,UAAU;AAC5BQ,YAAQA,MAAME,MAAN,CAAaC,QAAQA,KAAKC,GAAL,KAAad,OAAOO,EAAzC,CAAR;AACAG,UAAMK,IAAN,CAAW,EAAER,IAAIL,MAAN,EAAcY,KAAKd,OAAOO,EAA1B,EAAX;AACAP,WAAOS,IAAP,CAAY,cAAZ,EAA4BC,KAA5B;AACAV,WAAOQ,SAAP,CAAiBC,IAAjB,CAAsB,cAAtB,EAAsCC,KAAtC;AACD,GALD;;AAOAV,SAAOC,EAAP,CAAU,YAAV,EAAwB,MAAM;AAC5BS,YAAQA,MAAME,MAAN,CAAaC,QAAQA,KAAKC,GAAL,KAAad,OAAOO,EAAzC,CAAR;AACAP,WAAOS,IAAP,CAAY,cAAZ,EAA4BC,KAA5B;AACAV,WAAOQ,SAAP,CAAiBC,IAAjB,CAAsB,cAAtB,EAAsCC,KAAtC;AACD,GAJD;AAKD,CAbM","file":"socket-handler.js","sourcesContent":["import { joinAllChatRoom } from '../api/room/room.api';\nimport { pushMessage } from './push-message';\n\nexport const chatHandler = socket => {\n  socket.on('join', userId => {\n    joinAllChatRoom(userId, socket);\n  });\n\n  socket.on('newMessage', data => {\n    const { from, to, messages } = data;\n    pushMessage({ id: 10, from, to, messages });\n    socket.broadcast.to(to).emit('addMessage', { to, from, messages });\n  });\n};\n\nlet users = [];\nexport const onlineHandler = socket => {\n  socket.on('online', userId => {\n    users = users.filter(item => item.way !== socket.id);\n    users.push({ id: userId, way: socket.id });\n    socket.emit('updateOnline', users);\n    socket.broadcast.emit('updateOnline', users);\n  });\n\n  socket.on('disconnect', () => {\n    users = users.filter(item => item.way !== socket.id);\n    socket.emit('updateOnline', users);\n    socket.broadcast.emit('updateOnline', users);\n  });\n};\n"]}